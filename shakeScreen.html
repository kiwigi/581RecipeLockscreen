<!doctype html>
<html>
  <head>

    <link rel="stylesheet" href="stylesheet.css">
    <title>Recipe Lockscreen</title>

  </head>
  
  
  <body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.9.6/lottie.min.js" integrity="sha512-yAr4fN9WZH6hESbOwoFZGtSgOP+LSZbs/JeoDr02pOX4yUFfI++qC9YwIQXIGffhnzliykJtdWTV/v3PxSz8aw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>    
   
    <script>
    function getAccel(){
    DeviceMotionEvent.requestPermission().then(response => {
        if (response == 'granted') {
        // Add a listener to get smartphone acceleration 
            // in the XYZ axes (units in m/s^2)
            window.addEventListener('devicemotion', (event) => {
                console.log(event);
            });
       // Add a listener to get smartphone orientation 
           // in the alpha-beta-gamma axes (units in degrees)
            window.addEventListener('deviceorientation',(event) => {
                console.log(event);
            });
        }
    });
}
    if (typeof window.DeviceMotionEvent != 'undefined') {
    // Shake sensitivity (a lower number is more)
    var sensitivity = 20;

    // Position variables
    var x1 = 0, y1 = 0, z1 = 0, x2 = 0, y2 = 0, z2 = 0;

    // Listen to motion events and update the position
    window.addEventListener('devicemotion', function (e) {
        x1 = e.accelerationIncludingGravity.x;
        // y1 = e.accelerationIncludingGravity.y;
        z1 = e.accelerationIncludingGravity.z;
    }, false);

  

    // Periodically check the position and fire
    // if the change is greater than the sensitivity
    setInterval(function () {
        var change = Math.abs(z1-z2);
        shakeCounter = 0
        if (change > sensitivity) {
            
            shakeCounter++
            animation.play();
            document.getElementById("shakeProgress").value += 5;
        }
        if (document.getElementById("shakeProgress").value==100){
            animation.stop();
        }
  

        // Update new position
        x2 = x1;
        // y2 = y1;
        z2 = z1;
    }, 150);
}
    </script>
    
    <div class="screen">
      <p class="sTitle">Shake device to mix!</p>
      <button id="accelPermsButton"  class="button-64" onclick="getAccel()"><p>iOS users! Please click here to enable permissions </p></button>

      <img class='lock'src='assets/lock.png'/>
       <div class="bobaContainer">
        <!-- <div id="animationContainer"> -->

            <div id="lottie"></div>

        <!-- </div> -->
        <!-- <img class="boba2"src='assets/emptyBobaCup.png'/> -->
        <div class="indicatorDot" style="left:30%; top:30%;"></div>
        <div class="prog">
            <p class="mixLvl">Mix Level:</p>
            <progress style="height:200px;color:rgb(185, 185, 255);"class ='bar'id="shakeProgress" value=0 max="100">  </progress>
        </div>

        
       </div> 
    </div>
    <script src="lottie.js"></script>
    <script src="script.js"></script>

  </body>

</html>